        dvpy1(1:j0)=fsfc(i)%theta(j1:j2)-tpi
        dvpy1(1+j0:2*j0)=fsfc(i)%theta(j1:j2)
        dvpy1(1+2*j0:3*j0)=fsfc(i)%theta(j1:j2)+tpi
        dvpy2(1:j0)=fsfc(i)%rtor(j1:j2)
        dvpy2(1+j0:2*j0)=fsfc(i)%rtor(j1:j2)
        dvpy2(1+2*j0:3*j0)=fsfc(i)%rtor(j1:j2)
        dvpy3(1:j0)=fsfc(i)%ztor(j1:j2)
        dvpy3(1+j0:2*j0)=fsfc(i)%ztor(j1:j2)
        dvpy3(1+2*j0:3*j0)=fsfc(i)%ztor(j1:j2)
        CALL L3interp(dvpy2,dvpy1,3*j0,fsfc(i)%rtor,fsfc(i)%eta,fsfc(i)%ny)
        CALL L3interp(dvpy3,dvpy1,3*j0,fsfc(i)%ztor,fsfc(i)%eta,fsfc(i)%ny)

        IF (i0 == 2) THEN
           i=2+ngdx
           OPEN (10,file=ffile,form='formatted',position='append')
           write (10,*) 'FS at i and ra = ',i,ra(i)
           write (10,*) 'theta',fsfc(i)%ny0,' points'
           write (10,110) fsfc(i)%theta(j1:j2)
           write (10,*) 'R',fsfc(i)%ny0,' points'
           write (10,110) fsfc(i)%rtor(j1:j2)
           write (10,*) 'z',fsfc(i)%ny0,' points'
           write (10,110) fsfc(i)%ztor(j1:j2)
           CLOSE (10)
        END IF



        IF (i0 == 2) THEN
           i=2+ngdx
           OPEN (10,file=ffile,form='formatted',position='append')
           write (10,*) 'FS at i and ra = ',i,ra(i)
           write (10,*) 'theta',fsfc(i)%ny0,' points'
           write (10,110) fsfc(i)%theta(j1:j2)
           write (10,*) 'R',fsfc(i)%ny0,' points'
           write (10,110) fsfc(i)%rtor(j1:j2)
           write (10,*) 'z',fsfc(i)%ny0,' points'
           write (10,110) fsfc(i)%ztor(j1:j2)
           CLOSE (10)
110        FORMAT(5g15.7)
        END IF

