!...  profiles

  ne0=EXP(-wn*ra*ra)
  nn0=EXP(-wn)

  ni0=ne0-rhos2*svor*(ne0-nn0)

!  ne0=-wn*ra*ra
!  ni0=ne0-rhos2*svor

!...  profile diffusion and source functions
!...  normalise profile source function

  dvp0=(rho)/dxdif
  dvp1=(1.0-rho)/dxdif
  pdf=EXP(-dvp0*dvp0) + EXP(-dvp1*dvp1)

  dvp0=(rho)/dxsrc
  dvp1=(1.0-rho)/dxsrc
  psfl=EXP(-dvp0*dvp0)
  psfr=EXP(-dvp1*dvp1)
