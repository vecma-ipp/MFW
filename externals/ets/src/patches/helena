Index: src/helena/current_calculations.f90
===================================================================
--- src/helena/current_calculations.f90	(revision 252)
+++ src/helena/current_calculations.f90	(working copy)
@@ -37,6 +37,8 @@
     allocate(j_tor_loc((nr - 1) * (np - 1)))
     allocate(j_tor_av(nr))
     allocate(I_tor(nr))
+!DPC
+    I_tor_hat=0.0_R8
 
 !-- initialize I_tor_hat
     I_tor_hat = 0._r8

Property changes on: src/helena/current_calculations.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/flxint2.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/theta_derivative.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/initialization.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/fourier_backtransform.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mapping_mod.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/neo_helena.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_output.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/rpack.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_meshacc.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/psi_error.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam_ballooning.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_dat.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/arclength.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/radial_mesh.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/check_solution.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam_read_helena.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_corners.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/write_parameters.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/shape_from_points.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_gauss.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/dp_dpsi.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/remesh.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/profiles.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/betapol.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mercier.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/fgauss.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/safety_factor.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/initial_grid.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/write_old_equilibrium.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/write_equilibrium.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/flxint.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam_kgs.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native

Index: src/helena/diagnostics.f90
===================================================================
--- src/helena/diagnostics.f90	(revision 252)
+++ src/helena/diagnostics.f90	(working copy)
@@ -1,4 +1,4 @@
-subroutine diagnostics(a, xaxis, yaxis, zvol, zvolp, current)
+subroutine diagnostics(equilibrium_out, a, xaxis, yaxis, zvol, zvolp, current)
 !----------------------------------------------------------------------
 ! subroutine to evaluate output quantities
 !----------------------------------------------------------------------
@@ -19,8 +19,12 @@
   use matrix_calculations
   use phys_functions
 
+  use euitm_schemas
+
   implicit none
 
+  type(type_equilibrium) :: equilibrium_out
+
   real(r8), intent(in) :: a, xaxis, yaxis
   real(r8), dimension(nr), intent(out) :: zvol, zvolp
   real(r8), intent(out) :: current
@@ -126,6 +130,13 @@
   betapl = (8._r8 * pi / eps) * abs(parea) / carea**2
   current = abs(eps * carea / alfa)
 
+  equilibrium_out%global_param%beta_pol = betapl
+  equilibrium_out%global_param%beta_tor = beta
+  equilibrium_out%global_param%beta_normal = 1.256637 * beta / current
+  equilibrium_out%global_param%li = xli
+  equilibrium_out%global_param%mag_axis%position%r = xaxis
+  equilibrium_out%global_param%mag_axis%position%z = yaxis
+
   if (standard_output) then
     write(out_he, *)
     write(out_he, *) '***************************************'

Property changes on: src/helena/diagnostics.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam_initialization.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_parameter.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_interpolation.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_itm.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_spline.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_mesh.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native

Index: src/helena/helena.f90
===================================================================
--- src/helena/helena.f90	(revision 252)
+++ src/helena/helena.f90	(working copy)
@@ -1434,8 +1434,9 @@
   call current_calculations_destructor
 
 !-- diagnostics
+  call equilibrium_constructor(equilibrium_out(1), nr, nchi)
   if (verbosity > 3) write(txtout(13), 13) xaxis, yaxis
-  call diagnostics(a, xaxis, yaxis, zvol, zvolp, curr)
+  call diagnostics(equilibrium_out(1), a, xaxis, yaxis, zvol, zvolp, curr)
 !attention: diagnostics recalculates curr !!!
 
   if (verbosity > 2) then
@@ -1477,7 +1478,6 @@
   allocate(dp0(nr))
   allocate(drbphi(nr))
 
-  call equilibrium_constructor(equilibrium_out(1), nr, nchi)
   call mapping(cx, cy, xaxis, yaxis, a, equilibrium_out(1))
   call current_at_nodes(a, equilibrium_out(1))
   call plot_dat_2d_out('3d', equilibrium_out(1)%coord_sys%position%r, &

Property changes on: src/helena/helena.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mesh_accumulation.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/assign_code_parameters.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_suydam.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/dgamma_dpsi.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/soloviev.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam_bfield.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_nodes.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/ddrpack.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_ne_te_profile.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/cubic_polynomials.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_map.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/global_plasma_parameters.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/node_numbers.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/write_eqdsk.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/math_functions.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_helena_io.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_profiles.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_equilibrium.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/phys_profiles.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/scale_current.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/cubic_interp_1d.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/si_output.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/plot_dat_out_mod.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/wrapper_helena.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/solve_cubic.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/triangularity.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/suydam_pq.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/drpack.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/matrix_calculations.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/gaussian_points.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_solver.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/passing_particles.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/phys_functions.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/q_profile.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/mod_dete.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native


Property changes on: src/helena/plot_dat_2d_out_mod.f90
___________________________________________________________________
Added: svn:keywords
   + Id
Added: svn:eol-style
   + native

