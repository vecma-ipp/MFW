! + + + + + + + + + + + + + + + + + + + + + + + + + + + +  
!> Analytical functions for the calculation of the "analytic" solution
!>
!> \author R.Stankiewicz, D.Kalupin (???)
!>
!> \version "$Id: analytical_functions.f90 1290 2012-05-03 17:08:47Z coster $"
! + + + + + + + + + + + + + + + + + + + + + + + + + + + +  
MODULE ANALYTICAL_FUNCTIONS

  use itm_types
  use itm_constants
  IMPLICIT NONE

CONTAINS



!==============================================================
! +++ MAGNETIC GEOMETRY   
  REAL(R8) FUNCTION ARHO(I,NRHO)
    INTEGER , INTENT(IN)  ::I,NRHO
    ARHO=1.0_R8/(NRHO-1)*(I-1)
  END FUNCTION ARHO

  REAL(R8) FUNCTION AVPR(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    AVPR=X
  END FUNCTION AVPR

  REAL(R8) FUNCTION DTAVPR(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DTAVPR=0.0_R8
  END FUNCTION DTAVPR

  REAL(R8) FUNCTION DAVPR(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DAVPR=1.0_R8
  END FUNCTION DAVPR

  REAL(R8) FUNCTION AG1(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    AG1=1.
  END FUNCTION AG1

  REAL(R8) FUNCTION DAG1(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DAG1=0.0_R8
  END FUNCTION DAG1

  REAL(R8) FUNCTION DTAG1(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DTAG1=0.0_R8
  END FUNCTION DTAG1

  REAL(R8) FUNCTION AG2(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    AG2=1.0_R8
  END FUNCTION AG2

  REAL(R8) FUNCTION DAG2(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DAG2=0.0_R8
  END FUNCTION DAG2

  REAL(R8) FUNCTION DTAG2(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DTAG2=0.0_R8
  END FUNCTION DTAG2

  REAL(R8) FUNCTION AG3(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    AG3=1.0_R8
  END FUNCTION AG3

  REAL(R8) FUNCTION DAG3(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DAG3=0.0_R8
  END FUNCTION DAG3

  REAL(R8) FUNCTION AFDIA(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    AFDIA=1.0_R8+X
  END FUNCTION AFDIA

  REAL(R8) FUNCTION DAFDIA(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DAFDIA=1.0_R8
  END FUNCTION DAFDIA

  REAL(R8) FUNCTION ABT(T)
    REAL(R8) ,INTENT(IN)   :: T
    ABT=1.0_R8
  END FUNCTION ABT

  REAL(R8) FUNCTION DTABT(T)
    REAL(R8) ,INTENT(IN)   :: T
    DTABT=0.0_R8
  END FUNCTION DTABT




! +++ ANALYTICAL PLASMA PROFILES:
  REAL(R8) FUNCTION APSI(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    APSI=X**2*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION APSI

  REAL(R8) FUNCTION DTAPSI(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DTAPSI=X**2*.2_R8*COS(2.0_R8*ITM_PI*T)*2.0_R8*ITM_PI
  END FUNCTION DTAPSI

  REAL(R8) FUNCTION DAPSI(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DAPSI=2.0_R8*x*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DAPSI

  REAL(R8) FUNCTION DDAPSI(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DDAPSI=2.0_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DDAPSI

  REAL(R8) FUNCTION ANI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT (IN)   :: IION
    ANI=(1.e19_R8*(1.0_R8-X**2)+1.e18_R8)*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION ANI

  REAL(R8) FUNCTION DANI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT (IN)   :: IION
    DANI=-X*1.e19_R8*2.0_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DANI

  REAL(R8) FUNCTION DDANI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT (IN)   :: IION
    DDANI=-1.e19_R8*2.0_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DDANI

  REAL(R8) FUNCTION DTANI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT (IN)   :: IION
    DTANI=(1.e19_R8*(1.0_R8-X**2)+1.e18_R8)*.2_R8*COS(2*ITM_PI*T)*2.0_R8*ITM_PI
  END FUNCTION DTANI

  REAL(R8) FUNCTION ATI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT(IN )   :: IION
    ATI=(1.e6_R8*(1.0_R8-X**2)+1.e2_R8)*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION ATI

  REAL(R8) FUNCTION DTATI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT(IN )   :: IION
    DTATI=(1.e6_R8*(1.0_R8-X**2)+1.e2_R8)*.2_R8*COS(2*ITM_PI*T)*2.0_R8*ITM_PI
  END FUNCTION DTATI

  REAL(R8) FUNCTION DATI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT(IN )   :: IION
    DATI=-2.0_R8*X*1.e6_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DATI

  REAL(R8) FUNCTION DDATI(IION,X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    INTEGER, INTENT(IN )   :: IION
    DDATI=-2.0_R8*1.e6_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DDATI

  REAL(R8) FUNCTION ATE(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    ATE=(1.2E6_R8*(1.0_R8-X**2)+1.e2_R8)*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION ATE

  REAL(R8) FUNCTION DATE(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DATE=-2.0_R8*X*1.2E6_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DATE

  REAL(R8) FUNCTION DDATE(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DDATE=-2.0_R8*1.2E6_R8*(1+.2_R8*SIN(2*ITM_PI*T))
  END FUNCTION DDATE

  REAL(R8) FUNCTION DTATE(X,T)
    REAL(R8) ,INTENT(IN)   :: X,T
    DTATE=(1.2E6_R8*(1.0_R8-X**2)+1.e2_R8)*.2_R8*COS(2*ITM_PI*T)*2.0_R8*ITM_PI
  END FUNCTION DTATE

  REAL(R8) FUNCTION AVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AVTOR=1.e0_R8 +X**2*(1.0_R8+0.2_R8*SIN(2.0_R8*ITM_PI*T))
  END FUNCTION AVTOR

  REAL(R8) FUNCTION DAVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DAVTOR=2.0_R8*X*(1.0_R8+0.2_R8*SIN(2.0_R8*ITM_PI*T))   
  END FUNCTION DAVTOR

  REAL(R8) FUNCTION DDAVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DDAVTOR=2.0_R8*(1.0_R8+0.2_R8*SIN(2.0_R8*ITM_PI*T))    
  END FUNCTION DDAVTOR

  REAL(R8) FUNCTION DTAVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DTAVTOR=X**2*0.2_R8*COS(2.0_R8*ITM_PI*T)*2.0_R8*ITM_PI
  END FUNCTION DTAVTOR




! +++ TRANSPORT:

  REAL(R8) FUNCTION ACONVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    ACONVTOR=0.05_R8*X
  END FUNCTION ACONVTOR

  REAL(R8) FUNCTION DACONVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DACONVTOR=0.05_R8
  END FUNCTION DACONVTOR

  REAL(R8) FUNCTION ADVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    ADVTOR=0.1_R8*X
  END FUNCTION ADVTOR

  REAL(R8) FUNCTION DADVTOR(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DADVTOR=0.1_R8
  END FUNCTION DADVTOR

  REAL(R8) FUNCTION AVTI(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AVTI=0.05_R8*X
  END FUNCTION AVTI

  REAL(R8) FUNCTION DAVTI(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DAVTI=0.05_R8
  END FUNCTION DAVTI

  REAL(R8) FUNCTION AKAPPAE(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AKAPPAE=0.2_R8
  END FUNCTION AKAPPAE

  REAL(R8) FUNCTION DAKAPPAE(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DAKAPPAE=0.0_R8
  END FUNCTION DAKAPPAE

  REAL(R8) FUNCTION AV(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AV=0.00_R8
  END FUNCTION AV

  REAL(R8) FUNCTION DAV(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DAV=0.0_R8
  END FUNCTION DAV

  REAL(R8) FUNCTION AD(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AD=0.04_R8
  END FUNCTION AD

  REAL(R8) FUNCTION DAD(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    DAD=0.0_R8
  END FUNCTION DAD

  REAL(R8) FUNCTION AKATE(X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    AKATE=0.2_R8
  END FUNCTION AKATE

  REAL(R8) FUNCTION DAKATE(X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    DAKATE=0.0_R8
  END FUNCTION DAKATE

  REAL(R8) FUNCTION AVTE(X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    AVTE=0.0_R8
  END FUNCTION AVTE

  REAL(R8) FUNCTION DAVTE(X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    DAVTE=0.0_R8
  END FUNCTION DAVTE


  REAL(R8) FUNCTION ASIGMA(X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    ASIGMA=1.0_R8
  END FUNCTION ASIGMA




! +++ SOURCES:

  REAL(R8) FUNCTION ACURR_IMP(X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    ACURR_IMP=0.0_R8
  END FUNCTION ACURR_IMP


  REAL(R8) FUNCTION AUI_IMP(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AUI_IMP=0.0_R8
  END FUNCTION AUI_IMP

  REAL(R8) FUNCTION AQI_IMP(IION,X,T)
    REAL(R8) ,INTENT(IN)  :: X,T
    INTEGER, INTENT (IN)  :: IION
    AQI_IMP=0.0_R8
  END FUNCTION AQI_IMP

  REAL (R8) FUNCTION ASI_IMP(IION,X,T)
    REAL (R8) ,INTENT(IN)  ::X,T
    INTEGER , INTENT(IN)   :: IION
    ASI_IMP=0.0_R8
  END FUNCTION ASI_IMP

  REAL (R8) FUNCTION AQE_IMP(X,T)
    REAL (R8) ,INTENT(IN)  :: X,T
    AQE_IMP=0.0_R8
  END FUNCTION AQE_IMP



!==============================================================
!==============================================================


END MODULE ANALYTICAL_FUNCTIONS
