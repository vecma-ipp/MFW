! + + + + + + + + + + + + + + + + + + + + + + + + + + + +  
!> Test the equilibrium augmenter
!>
!> \author D. Coster
!>
!> \version "$Id$"
! + + + + + + + + + + + + + + + + + + + + + + + + + + + +  
program test_equilibrium_augmenter

  use euitm_schemas
  use euitm_routines
  use itm_types
  use equilibrium_augmenter
  USE XML_FILE_READER

  implicit none

  type (type_equilibrium), pointer :: equilibrium_in(:), equilibrium_out(:)
  type (type_param)                :: code_parameters
  integer :: idx, shot, run, i

  interface 
     subroutine eqaugm(eq_in, eq_out, code_parameters)
       use euitm_schemas
       implicit none
       type (type_equilibrium), pointer :: eq_in(:), eq_out(:)
       type (type_param)                :: code_parameters
     end subroutine eqaugm
  end interface

  call fill_param (code_parameters, 'XML/equilibrium_augmenter.xml', '', 'XML/equilibrium_augmenter.xsd')

  shot=20116
  run=702
  write(*,*) 'Reading ', shot, run
  call euitm_open ('euitm', shot, run, idx)
  call euitm_get  (idx, 'equilibrium', equilibrium_IN)
  call euitm_close(idx)

  call eqaugm(equilibrium_in, equilibrium_out, code_parameters)

  write(*,*) 'Writing ', shot, run+10000
  call euitm_create('euitm', shot, run+10000, 0, 0, idx)
  call euitm_put   (idx, 'equilibrium', equilibrium_out)
  call euitm_close (idx)

  stop

end program test_equilibrium_augmenter
